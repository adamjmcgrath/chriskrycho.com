<!DOCTYPE html>
<html lang="en">
<head>
    <title>Rust and Swift (xvi) &middot; Chris Krycho</title>
    <meta name="description" content="I am reading through the Swift book, and comparing it to Rust, which I have also been learning over the past few months. As with the other posts in this series, these are off-the-cuff impressions, which may be inaccurate in various ways. I’d be happy to hear feedback! Note ..."/>

    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>

<link rel='me' href='https://alpha.app.net/chriskrycho' data-type='follow' data-user-id='@chriskrycho'/>    <meta property="og:url" content="http://www.chriskrycho.com/drafts/rust-and-swift-xvi.html"/>
    <meta property="og:title" content="Rust and Swift (xvi)"/>
    <meta property="og:description" content="I am reading through the Swift book, and comparing it to Rust, which I have also been learning over the past few months. As with the other posts in this series, these are off-the-cuff impressions, which may be inaccurate in various ways. I’d be happy to hear feedback! Note ..."/>
        <meta property="og:image" content="http://www.chriskrycho.com//assets/images/ck.png"/>
<link rel="author" href=""/>
<link rel="me" href=""/><meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@chriskrycho"/>
<meta name="twitter:creator" content="@chriskrycho"/>
    <meta name="twitter:title" content="Rust and Swift (xvi)"/>
    <meta name="twitter:description" content="I am reading through the Swift book, and comparing it to Rust, which I have also been learning over the past few months. As with the other posts in this series, these are off-the-cuff impressions, which may be inaccurate in various ways. I’d be happy to hear feedback! Note ..."/>
        <meta name="twitter:image" content="http://www.chriskrycho.com/assets/images/ck.png"/>
    <link rel="me" href="https://bitbucket.org/chriskrycho"/>
    <link rel="me" href="https://twitter.com/chriskrycho"/>
    <link rel="me" href="https://vimeo.com/chriskrycho"/>
    <link rel="me" href="http://stackoverflow.com/users/564181/chris-krycho"/>
    <link rel="me" href="https://www.facebook.com/chriskrycho"/>
    <link rel="me" href="https://soundcloud.com/chriskrycho"/>
    <link rel="me" href="http://www.linkedin.com/in/chriskrycho"/>
    <link rel="me" href="http://instagram.com/chriskrycho"/>
    <link rel="me" href="https://github.com/chriskrycho"/>
    <link rel="me" href="https://medium.com/@chriskrycho"/>
    <link rel="me" href="mailto:chris at chriskrycho dot com"/>

    <link rel="openid.delegate" href="http://www.chriskrycho.com/" />
    <link rel="openid.server" href="https://indieauth.com/openid" />

    <link rel="stylesheet" type="text/css" href="http://www.chriskrycho.com/assets/style.css"/>
    <link rel="stylesheet" type="text/css" href="http://www.chriskrycho.com/assets/fonts.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <link href="/favicon.png" type="image/png" rel="icon" />
    <link href="/favicon.ico" type="image/ico" rel="icon" />

    <script type="text/javascript" src="/assets/js/mtiFontTrackingCode.js"></script>

    <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="All posts">
        <link rel="alternate" href="/feeds/art.xml" type="application/rss+xml" title="Posts filed in in 'Art''">
        <link rel="alternate" href="/feeds/blog.xml" type="application/rss+xml" title="Posts filed in in 'Blog''">
        <link rel="alternate" href="/feeds/micro.xml" type="application/rss+xml" title="Posts filed in in 'Micro''">
        <link rel="alternate" href="/feeds/tech.xml" type="application/rss+xml" title="Posts filed in in 'Tech''">
        <link rel="alternate" href="/feeds/Theology.xml" type="application/rss+xml" title="Posts filed in in 'Theology''">
</head>
<body>
    <header id="site-header">
        <div class="hgroup">
            <h1 id="site-title">
<a href="http://www.chriskrycho.com"><img class="logotype" src="/assets/images/ck.png" alt="ck"/>Chris Krycho</a>
</h1>

            <h2 id="site-subtitle">Theology, technology, life & art</h2>
        </div>

        <nav>
            <ul>
                <li class="section-title"><a href="http://www.chriskrycho.com/about.html">About</a></li>
                <li class="section-title art"><a href="http://www.chriskrycho.com/art/">art</a></li>
                <li class="section-title tech"><a href="http://www.chriskrycho.com/tech/">tech</a></li>
                <li class="section-title theology"><a href="http://www.chriskrycho.com/theology/">Theology</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="http://www.chriskrycho.com/series.html">Series</a></li>
                <li class="section-title divider" role="presentation"></li>
                <li class="section-title"><a href="http://www.chriskrycho.com/archives.html">Archives</a></li>
            </ul>
        </nav>

    </header>


<article class="rust swift rust-and-swift programming-languages tech">

    <header>
<h1>Rust and Swift (xvi)</h1>
<h2>Initialization: another area where Swift has a lot more going on than Rust.</h2>    </header>

    <div class="meta"><span class="date"><a href="http://www.chriskrycho.com/drafts/rust-and-swift-xvi.html"><i class="fa fa-fw fa-link"></i></a>March 19, 2016</span><span class="section">Filed under <a class="section-title" href="http://www.chriskrycho.com/tech/">tech</a></span><span class="hashtag"><a class="hashtags" href="http://www.chriskrycho.com/programming-languages/">#programming languages</a><a class="hashtags" href="http://www.chriskrycho.com/rust/">#rust</a><a class="hashtags" href="http://www.chriskrycho.com/rust-and-swift/">#rust-and-swift</a><a class="hashtags" href="http://www.chriskrycho.com/swift/">#swift</a></span><span><a href="http://www.chriskrycho.com/2016/rust-and-swift-xvi.txt">Markdown source</a></span></div>

    <div class="content-wrapper">


        <div class="content">

<p><i class="editorial">I am reading through the Swift book, and comparing it to Rust, which I have also been learning over the past few months. As with the other posts in this series, these are off-the-cuff impressions, which may be inaccurate in various ways. I’d be happy to hear feedback! Note, too, that my preferences are just that: preferences. Your tastes may differ from mine. <a href="http://www.chriskrycho.com/rust-and-swift.html">(See all parts in the series.)</a></i></p>
<p><i class="editorial">Thanks to ubsan, aatch, and niconii on the <a href="">#rust-lang IRC</a> for a fascinating discussion of the current status of Rust’s initialization analysis, as well as some very interesting comments on what might be possible to do in the future. Everything actually interesting about Rust in this post comes from the conversation I had with them on the evening of March 13.</i></p>
<hr />
<p>The rules various languages have around construction and destruction of objects are <em>extremely</em> important for programmer safety and ergonomics. I think it’s fair to say that both Swift and rust are actively trying to avoid some of the mistakes made in e.g. C++ which poorly affect both its safety and its ease of use for developers, albeit it in some superficially different ways.</p>
<p>The basic aim both Rust and Swift have in this area seems to be the same: avoid <em>partially</em> initialized objects.</p>
<p>Swift does this via its rules around <em>initializers</em>. Rust does it by requiring that all the values of a type be initialized at its creation. So, for example, the following <em>looks</em> like it should work, but as the comment explains, it doesn’t. You can initialize the variable piecemeal, but you cannot <em>use</em> it.</p>
<pre class="rust"><code>#[derive(Debug)]
struct Foo {
    pub a: i32,
    pub b: f64,
}

fn main() {
    let mut foo: Foo;
    foo.a = 14;
    foo.b = 42.0;

    // You can&#39;t do this because of the following:
    // 1. the ability to move out of a struct per-field
    // 2. the ability to re-initialize moved variables.
    // 3. treating uninitialized variables the same as moved-from variables.
    // println!(&quot;{:?}&quot;, foo);
}</code></pre>
<p>As a result, especially with more complex data types, providing standard constructor-style methods like <code>new</code> or <code>default</code> is conventional and helpful. (If the type has non-public members, it’s also strictly necessary.)</p>
<p>Swift has a number of options for initializers, which correspond to things you variously can odd in Rust, but in a very different way.</p>
<p>First, Swift allows you to overload the <code>init</code> method on a type, so that you can have different constructors for different starting conditions. (This is, to my recollection, the first time any kind of overloading has come up so far in the Swift book—but that could just be my memory failing me. Certainly I haven’t referenced it in any previous discussion, though.)</p>
<p>The example offered by the Swift book is illuminating for the different approaches the languages take, so we’ll run with it. Here’s a class defining a Celsius type in Swift:</p>
<pre class="swift"><code>struct Celsius {
    let temp: Double
    
    init(fromFahrenheit f: Double) {
       temp = 1.8 * (f - 32.0)
    }
    
    init(fromKelvin k: Double) {
        temp = k - 273.15
    }
}

// Create an instance each way
let freezing = Celsius(temp: 0)
let balmy = Celsius(fromFahrenheit: 75.0)
let absoluteZero = Celsius(fromKelvin: 0.0)</code></pre>
<p>And the same in Rust:</p>
<pre class="rust"><code>struct Celsius {
    temp: f64
}

impl Celsius {
    fn from_fahrenheit(f: f64) {
        Celsius { temp: 1.8 * (f - 32.0) }
    }
    
    fn from_kelvin(k: f64) {
        Celsius { temp: k - 273.15 }
    }
}

// Create an instance each way
let freezing = Celsius { temp: 0 };
let balmy = Celsius::from_fahrenheit(75.0);
let absoluteZero = Celsius::from_kelvin(0.0);</code></pre>
<p>(Note that there might be other considerations in implementing such types, like using a <code>Temperature</code> base <code>trait</code> or <code>protocol</code>, or employing type aliases, but those are for later entries!)</p>
<p>You can see a point I made about Swift’s initializer syntax back in <a href="http://www.chriskrycho.com/2016/rust-and-swift-x.html">part x</a>: the way Rust reuses normal struct methods while Swift has the special initializers. Neither is clearly the “winner” here: Rust gets to use existing language machinery, simplifying the model a bit, but the addition of initializer syntax lets Swift use a fairly familiar type construction syntax even for special initializer cases, and a bit less noise in the constructor method. Note, though, that initializers in Swift <em>are</em> special syntax; they re not just a special kind of method (as the absence of the <code>func</code> keyword emphasizes).</p>
<hr />
<ul>
<li><a href="http://www.chriskrycho.com/2016/rust-and-swift-xv.html"><strong>Previous:</strong> Inheritance: a Swiftian specialty (for now).</a></li>
</ul>
<div id="refs" class="references">

</div>
        </div>
    </div>
</article>


    <footer id="site-footer"><section id="connect">
    <h2>Connect</h2>
    <ul class="icons">
        <li><a href="https://twitter.com/chriskrycho"><i class="fa fa-fw fa-twitter"></i>Twitter</a></li>
        <li><a href="mailto:chris at chriskrycho dot com"><i class="fa fa-fw fa-envelope"></i>Email</a></li>
        <li><a href="https://github.com/chriskrycho"><i class="fa fa-fw fa-github"></i>GitHub</a></li>
        <li><a href="https://medium.com/@chriskrycho"><i class="fa fa-fw fa-medium"></i>Medium</a></li>
        <li><a href="https://soundcloud.com/chriskrycho"><i class="fa fa-fw fa-soundcloud"></i>SoundCloud</a></li>
        <li><a href="http://instagram.com/chriskrycho"><i class="fa fa-fw fa-instagram"></i>Instagram</a></li>
        <li><a href="http://www.linkedin.com/in/chriskrycho"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a></li>
        <li><a href="https://vimeo.com/chriskrycho"><i class="fa fa-fw fa-vimeo"></i>Vimeo</a></li>
        <li><a href="http://stackoverflow.com/users/564181/chris-krycho"><i class="fa fa-fw fa-stack-overflow"></i>Stack Overflow</a></li>
    </ul>
</section>
<section id="subscribe">
    <h2>Subscribe</h2>
    <ul class="icons">
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feed.xml"><i class="fa fa-fw fa-rss"></i>Everything</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/art.xml"><i class="fa fa-fw fa-rss"></i>art</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/blog.xml"><i class="fa fa-fw fa-rss"></i>blog</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/micro.xml"><i class="fa fa-fw fa-rss"></i>micro</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/tech.xml"><i class="fa fa-fw fa-rss"></i>tech</a>
        </li>
        <li class="section-title">
            <a href="http://www.chriskrycho.com/feeds/Theology.xml"><i class="fa fa-fw fa-rss"></i>Theology</a>
        </li>
    </ul>
</section>
<section id="recent">
    <h2>Recent</h2>
    <ul>
        <li>Art: <a href="http://www.chriskrycho.com/2016/even-easter-morning.html">even Easter morning</a></li>
        <li>Blog: <a href="http://www.chriskrycho.com/2016/trust-fame-and-deceit.html">Trust, Fame, and Deceit</a></li>
        <li>Tech: <a href="http://www.chriskrycho.com/2016/ulysses-byword-and-just-right.html">Ulysses, Byword, and “Just Right”</a></li>
        <li>Theology: <a href="http://www.chriskrycho.com/2016/the-titles-father-son-and-holy-spirit-as-denoting-being-not-activity.html">The Titles Father, Son, and Holy Spirit as Denoting Being, Not Activity</a></li>
    </ul>
</section></footer>

    <script async src="http://code.bib.ly/bibly.min.js"></script>
    <link href="http://code.bib.ly/bibly.min.css" rel="stylesheet" />
    <script type="text/javascript">
    var MTIProjectId='a34d2e31-99b5-469a-9b81-128fc0bd9745';
    </script>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/tomorrow.min.css">
<script src="/assets/js/highlight.pack.js"></script>
<script type="text/javascript">
// Get all the <pre><code> elements, and use the <pre> element to set the <code>
// element's class so hljs will use it rather than trying to figure it out.
var preEls = document.getElementsByTagName('pre');
for (var e in preEls) {
    var pre = preEls[e];
    if (pre.firstChild && pre.firstChild.tagName === 'CODE') {
        var code = pre.firstChild;
        code.className = pre.className;
    }
}

// Then run hljs.
hljs.initHighlightingOnLoad();
</script>

<script type="text/javascript" src="/assets/js/spacewell.js"></script>
<script type="text/javascript">
var articles = document.getElementsByTagName('article');
var options = {'emDashes': true, 'enDashes': true};
for (var a in articles) {
  if (articles.hasOwnProperty(a)) { spacewell(articles[a], options); }
}
</script>
</body>
</html>